function W(e,t,s,h=b=>b){return e*h(.5-t*(.5-s))}function re(e){return[-e[0],-e[1]]}function l(e,t){return[e[0]+t[0],e[1]+t[1]]}function a(e,t){return[e[0]-t[0],e[1]-t[1]]}function f(e,t){return[e[0]*t,e[1]*t]}function le(e,t){return[e[0]/t,e[1]/t]}function L(e){return[e[1],-e[0]]}function ne(e,t){return e[0]*t[0]+e[1]*t[1]}function oe(e,t){return e[0]===t[0]&&e[1]===t[1]}function fe(e){return Math.hypot(e[0],e[1])}function be(e){return e[0]*e[0]+e[1]*e[1]}function Y(e,t){return be(a(e,t))}function G(e){return le(e,fe(e))}function ue(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function T(e,t,s){let h=Math.sin(s),b=Math.cos(s),v=e[0]-t[0],n=e[1]-t[1],g=v*b-n*h,E=v*h+n*b;return[g+t[0],E+t[1]]}function V(e,t,s){return l(e,f(a(t,e),s))}function Z(e,t,s){return l(e,f(t,s))}var{min:_,PI:ge}=Math,se=.275,j=ge+1e-4;function ie(e,t={}){let{size:s=16,smoothing:h=.5,thinning:b=.5,simulatePressure:v=!0,easing:n=r=>r,start:g={},end:E={},last:z=!1}=t,{cap:d=!0,taper:x=0,easing:q=r=>r*(2-r)}=g,{cap:m=!0,taper:c=0,easing:M=r=>--r*r*r+1}=E;if(e.length===0||s<=0)return[];let H=e[e.length-1].runningLength,$=Math.pow(s*h,2),D=[],R=[],N=e.slice(0,10).reduce((r,i)=>{let o=i.pressure;if(v){let u=_(1,i.distance/s),J=_(1,1-u);o=_(1,r+(J-r)*(u*se))}return(r+o)/2},e[0].pressure),p=W(s,b,e[e.length-1].pressure,n),U,B=e[0].vector,I=e[0].point,C=I,y=I,O=C;for(let r=0;r<e.length;r++){let{pressure:i}=e[r],{point:o,vector:u,distance:J,runningLength:K}=e[r];if(r<e.length-1&&H-K<3)continue;if(b){if(v){let P=_(1,J/s),Q=_(1,1-P);i=_(1,N+(Q-N)*(P*se))}p=W(s,b,i,n)}else p=s/2;U===void 0&&(U=p);let pe=K<x?q(K/x):1,ae=H-K<c?M((H-K)/c):1;if(p=Math.max(.01,p*Math.min(pe,ae)),r===e.length-1){let P=f(L(u),p);D.push(a(o,P)),R.push(l(o,P));continue}let A=e[r+1].vector,ee=ne(u,A);if(ee<0){let P=f(L(B),p);for(let Q=1/13,w=0;w<=1;w+=Q)y=T(a(o,P),o,j*w),D.push(y),O=T(l(o,P),o,j*-w),R.push(O);I=y,C=O;continue}let te=f(L(V(A,u,ee)),p);y=a(o,te),(r<=1||Y(I,y)>$)&&(D.push(y),I=y),O=l(o,te),(r<=1||Y(C,O)>$)&&(R.push(O),C=O),N=i,B=u}let S=e[0].point.slice(0,2),k=e.length>1?e[e.length-1].point.slice(0,2):l(e[0].point,[1,1]),X=[],F=[];if(e.length===1){if(!(x||c)||z){let r=Z(S,G(L(a(S,k))),-(U||p)),i=[];for(let o=1/13,u=o;u<=1;u+=o)i.push(T(r,S,j*2*u));return i}}else{if(!(x||c&&e.length===1))if(d)for(let i=1/13,o=i;o<=1;o+=i){let u=T(R[0],S,j*o);X.push(u)}else{let i=a(D[0],R[0]),o=f(i,.5),u=f(i,.51);X.push(a(S,o),a(S,u),l(S,u),l(S,o))}let r=L(re(e[e.length-1].vector));if(c||x&&e.length===1)F.push(k);else if(m){let i=Z(k,r,p);for(let o=1/29,u=o;u<1;u+=o)F.push(T(i,k,j*3*u))}else F.push(l(k,f(r,p)),l(k,f(r,p*.99)),a(k,f(r,p*.99)),a(k,f(r,p)))}return D.concat(F,R.reverse(),X)}function ce(e,t={}){var q;let{streamline:s=.5,size:h=16,last:b=!1}=t;if(e.length===0)return[];let v=.15+(1-s)*.85,n=Array.isArray(e[0])?e:e.map(({x:m,y:c,pressure:M=.5})=>[m,c,M]);if(n.length===2){let m=n[1];n=n.slice(0,-1);for(let c=1;c<5;c++)n.push(V(n[0],m,c/4))}n.length===1&&(n=[...n,[...l(n[0],[1,1]),...n[0].slice(2)]]);let g=[{point:[n[0][0],n[0][1]],pressure:n[0][2]>=0?n[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],E=!1,z=0,d=g[0],x=n.length-1;for(let m=1;m<n.length;m++){let c=b&&m===x?n[m].slice(0,2):V(d.point,n[m],v);if(oe(d.point,c))continue;let M=ue(c,d.point);if(z+=M,m<x&&!E){if(z<h)continue;E=!0}d={point:c,pressure:n[m][2]>=0?n[m][2]:.5,vector:G(a(d.point,c)),distance:M,runningLength:z},g.push(d)}return g[0].vector=((q=g[1])==null?void 0:q.vector)||[0,0],g}function me(e,t={}){return ie(ce(e,t),t)}var Te=me;export{Te as default,me as getStroke,ie as getStrokeOutlinePoints,ce as getStrokePoints};
